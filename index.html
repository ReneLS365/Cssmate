<!DOCTYPE html>
<html lang="da">
<head>
  <!-- force build -->

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name="description" content="CSMate ‚Äì stilladsopt√¶lling, akkord og PWA til byggepladsen.">
  <meta name="theme-color" content="#0f172a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>akkordseddel</title>

  <script type="importmap">
    {
      "imports": {
        "@fireproof/core": "https://esm.sh/@fireproof/core@0.24.0",
        "@fireproof/partykit": "https://esm.sh/@fireproof/partykit@0.19.118"
      }
    }
  </script>
  <script src="/js/firebase-env.js"></script>
  <script src="/js/version.js"></script>
  <style>:root{--bg:#1e1f22;--elev:#26272b;--panel:#2d2f34;--panel-soft:#2b2d32;--panel-muted:#26272c;--text:#f4f4f6;--muted:#c8c9ce;--border:#3b3d45;--accent:#8ea0b5;--accent-strong:#f2b661;--radius-md:10px;--radius-lg:16px;--shadow-strong:0 18px 40px rgba(0,0,0,0.45);--gap:12px;--pad:12px;--materials-grid-desktop:2fr minmax(64px,0.9fr) minmax(72px,1fr) minmax(72px,1fr);--materials-grid-mobile:1.4fr minmax(56px,0.8fr) minmax(64px,0.9fr) minmax(64px,0.9fr);--header-height:56px;--tab-bar-height:52px;--tab-panels-min-height:calc(100svh - var(--header-height) - var(--tab-bar-height) - 24px)}:focus-visible{outline:currentColor solid 2px;outline-offset:2px}.skip-to-content{position:absolute;left:-9999px;top:0;background:var(--panel);color:var(--text);padding:8px 14px;border-radius:10px;z-index:1000;box-shadow:0 12px 30px rgba(0,0,0,.4)}.ios-install-prompt{position:fixed;bottom:1.25rem;left:50%;transform:translateX(-50%);background:var(--panel);color:var(--text);padding:14px 16px;border-radius:14px;border:1px solid var(--border);box-shadow:0 18px 40px rgba(0,0,0,.45);display:flex;gap:12px;align-items:center;max-width:min(420px,90vw);line-height:1.4;z-index:900}.ios-install-prompt p{margin:0}.ios-install-prompt strong{color:var(--accent)}.ios-install-prompt[hidden]{display:none}.ios-install-dismiss{border:1px solid var(--border);background:0 0;color:var(--text);width:32px;height:32px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-size:1rem;padding:0}@media (prefers-reduced-motion:reduce){*,::after,::before{animation-duration:0s!important;animation-iteration-count:1!important;scroll-behavior:auto!important}}*{box-sizing:border-box}body,html{margin:0;min-height:100%;width:100%;max-width:100vw;overflow-x:hidden;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}html{-ms-touch-action:manipulation;touch-action:manipulation}.app-content,.app-shell,.materials-scroll,body,html{min-height:100%}body{font-size:16px;line-height:1.45;font-weight:400;background-color:var(--bg,#121212);overscroll-behavior-y:contain}.app-content,.app-shell,.materials-scroll{max-width:100vw}@media (max-width:420px){.app-content,.app-shell,header,main{width:100%;max-width:100vw}}.app-shell{display:flex;flex-direction:column}.app-content{flex:1 1 auto;min-height:0;display:flex;flex-direction:column}.materials-scroll{flex:1 1 auto;min-height:0;display:flex;flex-direction:column;overscroll-behavior:contain;padding-bottom:0!important}.materials-scroll>:last-child{margin-bottom:0!important}@supports not (height:100dvh){.app-shell{height:var(--app-vh,100vh)}}header{position:sticky;top:0;background:var(--elev);border-bottom:1px solid var(--border);z-index:5}header .bar{display:flex;gap:8px;align-items:center;justify-content:space-between;padding:6px 10px;min-height:var(--header-height)}header .ttl{font-weight:700}.tabs{display:flex;gap:.35rem;overflow-x:auto;padding:.25rem 0;border-radius:.75rem;-webkit-overflow-scrolling:touch;scrollbar-width:thin;scrollbar-color:var(--accent) transparent;touch-action:pan-x;scrollbar-gutter:stable both-edges;overscroll-behavior-x:contain;flex:1 1 auto;min-width:0;max-width:100%}.table-wrapper{overscroll-behavior:auto}.tabs::-webkit-scrollbar{height:4px}.tab{flex:0 0 auto;scroll-snap-align:start;min-width:4.5rem;padding:.55rem .9rem;font-size:.95rem;border-radius:.45rem;border:1px solid rgba(255,255,255,.08);background:var(--panel);color:var(--muted);font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tab--active{background:var(--accent);color:#0b1623;font-weight:600;border-color:var(--accent)}.tab-panel{display:none;width:100%;min-height:0}.tab-panel.tab-panel--active{display:flex;flex-direction:column;gap:var(--gap);min-height:0}#panel-lon{flex-direction:column;flex:1 1 auto;min-height:0;overflow-y:auto;padding-bottom:calc(env(safe-area-inset-bottom,0) + 4rem);scroll-padding-bottom:calc(env(safe-area-inset-bottom,0) + 4rem)}.tab,button{min-height:44px;min-width:44px;padding:.5rem .75rem;touch-action:manipulation}.tab,button[data-role=primary]{position:relative}.tab::after,button[data-role=primary]::after{content:"";position:absolute;top:-8px;bottom:-8px;left:-8px;right:-8px;background:0 0}input[type=text],select{min-height:44px;line-height:1.3;padding:.45rem .6rem;font-size:1.05rem}main{display:block;width:100%}.app-root{max-width:540px;margin:0 auto;padding:0 .75rem 1.5rem;display:flex;flex-direction:column;flex:1 1 auto;min-height:0;width:100%}.tab-panels{flex:1 1 auto;min-height:var(--tab-panels-min-height,60vh);overflow-y:auto;scrollbar-gutter:stable both-edges;padding:clamp(.5rem,2vw,1rem) 0 clamp(1rem,4vw,1.75rem);width:100%;margin:0 auto;overflow-anchor:none}.tab-panel{min-width:0}fieldset{border:1px solid var(--border);background:var(--panel);border-radius:12px;margin:0;padding:var(--pad)}.card{border:1px solid var(--border);background:var(--panel);border-radius:12px;padding:.75rem .9rem;display:flex;flex-direction:column;gap:var(--gap);content-visibility:auto;contain-intrinsic-size:320px}.card-header{display:flex;flex-direction:column;gap:.35rem}.card-header h2{margin:0;font-size:1.15rem}.card-header p{margin:0;color:var(--muted);font-size:.9rem}legend{color:var(--muted);padding:0 6px}label{display:flex;flex-direction:column;gap:6px;font-size:.95rem}label span{color:var(--muted);font-size:.85rem}.form-field{display:flex;flex-direction:column;gap:6px;font-size:.95rem}.form-actions{margin-top:var(--gap);display:flex;justify-content:flex-end;gap:.5rem;flex-wrap:wrap}.form-actions button{min-width:160px;flex:0 1 200px}.date-field .date-input-wrapper{display:flex;align-items:center;gap:8px}.date-field .date-input-wrapper input[type=date]{flex:1}.date-picker-trigger{display:inline-flex;align-items:center;justify-content:center;min-height:44px;min-width:44px;padding:0 12px;font-size:1.25rem;line-height:1;border:1px solid var(--border);background:var(--elev)}button,input,select,textarea{background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:10px;min-height:44px;padding:10px;font-size:16px;max-width:100%;box-sizing:border-box}textarea{resize:vertical}.sektion{flex-direction:column;gap:var(--gap)}.row{display:flex;gap:8px;flex-wrap:wrap}.btn-group{display:flex;gap:8px;flex-wrap:wrap}.job-history{gap:var(--gap)}.job-history__controls{display:flex;flex-wrap:wrap;gap:var(--gap);align-items:flex-end}.job-history__controls label{flex:1 1 220px}.job-history__controls button{flex:0 0 auto;min-width:160px}.job-history__summary{overflow-x:auto}.job-history__summary table{width:100%;border-collapse:collapse;min-width:520px}.job-history__summary td,.job-history__summary th{text-align:left;padding:.5rem;border-bottom:1px solid var(--border);white-space:nowrap}.job-history__summary th{color:var(--muted);font-size:.85rem;font-weight:600}.job-history__summary td{font-variant-numeric:tabular-nums}.job-history__list h3{margin:0 0 .25rem;font-size:1rem}.job-history__hint{margin:0 0 .75rem;font-size:.85rem;color:var(--muted)}.job-history__list{display:flex;flex-direction:column;gap:.5rem}.export-panel{gap:.75rem}.export-actions{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:.5rem}.export-actions button{padding:.4rem .5rem;font-size:.85rem;border-radius:.75rem;background:var(--panel-soft);border:1px solid var(--border)}.export-system-selector{display:flex;flex-direction:column;gap:.35rem;padding:.75rem;border:1px dashed var(--border);border-radius:10px;background:var(--panel-soft)}.export-system-selector legend{padding:0 4px;font-size:.95rem}.export-system-options{display:flex;flex-direction:column;gap:.35rem}.export-system-option{display:flex;align-items:flex-start;gap:.5rem;font-size:.9rem;color:var(--text)}.export-system-option input{margin-top:.2rem}.export-system-option__label{font-weight:500}.export-system-option__hint{display:block;font-size:.75rem;color:var(--muted)}.history-list{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:.35rem;color:var(--muted);font-size:.9rem}.table-wrapper{width:100%;overflow-x:auto}.table-wrapper table{width:100%;border-collapse:collapse;font-size:.85rem}.table-wrapper td,.table-wrapper th{padding:.25rem .35rem;text-align:left;white-space:nowrap}.table-wrapper th{font-weight:600}.grid-3{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:var(--gap)}.grid-2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--gap)}.form-grid{padding:var(--pad);background:var(--panel);border-radius:12px}.col-span-3{grid-column:1/-1}.materials{--name-col:minmax(0, 1.8fr);--qty-col:clamp(52px, 14vw, 100px);--price-col:clamp(60px, 16vw, 110px);--total-col:clamp(64px, 20vw, 128px);--materials-grid:var(--name-col) var(--qty-col) var(--price-col) var(--total-col);display:flex;flex-direction:column;width:100%}.overview{background:var(--elev);border:1px solid var(--border);border-radius:12px;padding:var(--pad)}.totals{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:var(--gap)}.totals div{display:flex;flex-direction:column;gap:4px;background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:12px}.totals span{color:var(--muted);font-size:.85rem}.totals strong{font-size:1.25rem}.hint{font-size:.9rem;color:var(--muted);margin:0}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.overview-inline{background:0 0;border:none;padding:0}.overview-inline .totals div{background:var(--elev)}.extra-work-grid{grid-template-columns:repeat(auto-fit,minmax(180px,1fr))}.status-message{margin:6px 0 0;font-size:.85rem}.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;padding:24px;z-index:999}.modal[hidden]{display:none!important}.modal-content{position:relative;background:var(--panel);border-radius:16px;border:1px solid var(--border);padding:24px;max-width:min(640px,90vw);width:100%;max-height:90vh;overflow:auto;box-shadow:0 20px 50px rgba(0,0,0,.4);outline:0}.modal-content h2{margin-top:0}.modal-content ol{padding-left:22px;line-height:1.6}.modal-content p{line-height:1.6}.modal-close{position:absolute;top:16px;right:16px;width:36px;height:36px;border-radius:50%;border:1px solid var(--border);background:#3a3c43;color:var(--text);font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center}@media (max-width:600px){header .bar{flex-direction:column;align-items:flex-start}.grid-3{grid-template-columns:1fr}.grid-2{grid-template-columns:1fr}.totals{grid-template-columns:1fr}.btn-group{flex-direction:column}.tab-panels{padding:.5rem .75rem 1rem}}@media (max-width:480px){body{font-size:15px;line-height:1.4}.tabs .tab{flex:1 1 auto;width:auto}header .bar{gap:12px}.form-actions button{flex:1 1 100%;min-width:0}}@media (max-width:360px){body{font-size:14px;line-height:1.35}.tabs{padding-inline:0.25rem}.tab,button{min-height:52px;min-width:52px;padding:.65rem .9rem;font-size:1rem}}@media (min-width:361px) and (max-width:480px){.tab,button{min-height:48px;min-width:48px;padding:.55rem .85rem;font-size:.95rem}}@media (min-width:481px){.tab,button{min-height:44px;min-width:44px;padding:.45rem .8rem;font-size:.9rem}}@media (max-width:420px){#app,.app-root{width:100%;max-width:100%;margin:0 auto;padding-inline:8px}main{padding:12px 0;gap:10px}.card,.form-grid,.overview,fieldset{padding:10px 12px}header .bar{padding-inline:8px}}:root{--primary:var(--accent);--fg:var(--panel)}.material-options{display:flex;align-items:center;margin-bottom:var(--gap);margin-left:28px}.material-options .toggle-selected{display:flex;align-items:center;gap:8px;font-size:.9rem}.material-options input{width:18px;height:18px}.material-options input[type=checkbox]{appearance:none;display:inline-grid;place-content:center;width:18px;height:18px;border:2px solid var(--accent);border-radius:4px;background:#2f3238}.material-options input[type=checkbox]::after{content:"";width:10px;height:10px;transform:scale(0);background:var(--fg);mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="10" viewBox="0 0 12 10"><path fill="%23000" d="M4.0 7.2L1.5 4.8 0.4 5.9 4.0 9.5 11.6 1.9 10.5 0.8z"/></svg>') no-repeat center/contain}.field-with-icon{display:flex;align-items:center;gap:6px}.field-with-icon input{flex:1}.a9-open-btn{min-width:40px;min-height:40px;border-radius:12px;border:none;background:#1e2533;color:#f4f6fb;font-size:22px;display:inline-flex;align-items:center;justify-content:center;touch-action:manipulation}.help-text.small-muted{margin-top:4px;white-space:pre-wrap}.pwa-install-wrap{position:fixed;right:12px;bottom:12px;z-index:9999}.pwa-install-btn{padding:10px 14px;border-radius:12px;border:none;box-shadow:0 6px 18px rgba(0,0,0,.15);font-weight:600;background:#0b0b0b;color:#fff}</style>
  <link rel="stylesheet" href="style.css" media="print" fetchpriority="high" onload="this.media='all'">
  <link rel="preload" href="css/numpad.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="css/a9-calc.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="stylesheet" href="print.css" media="print" onload="this.media='print'">
  <link rel="preload" href="src/styles/fixes.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="/css/pwa.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="modulepreload" href="/main.min.js">
  <noscript>
    <link rel="stylesheet" href="css/numpad.css">
    <link rel="stylesheet" href="css/a9-calc.css">
    <link rel="stylesheet" href="src/styles/fixes.css">
    <link rel="stylesheet" href="/css/pwa.css">
  </noscript>
  <link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">
  <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">
  <link rel="canonical" href="https://sscaff.netlify.app/">
</head>
<body>
  <a class="skip-to-content" href="#main">Spring til indhold</a>
  <section id="iosInstallPrompt" class="ios-install-prompt" aria-live="polite" hidden>
    <p>Tilf√∏j CSMate til hjemmesk√¶rmen: Tryk p√• delingsknappen og v√¶lg <strong>F√∏j til hjemmesk√¶rm</strong>.</p>
    <button type="button" id="iosInstallDismiss" class="ios-install-dismiss" aria-label="Skjul iOS installationshint">‚úï</button>
  </section>
  <div class="pwa-install-wrap no-print">
    <button type="button" id="installBtn" class="pwa-install-btn" hidden>Installer app</button>
  </div>
  <section id="authGate" class="auth-gate no-print" aria-live="polite" hidden>
    <div class="auth-card" role="dialog" aria-modal="true" aria-labelledby="authTitle">
      <div id="authLoadingScreen" class="auth-section">
        <h2 id="authTitle">Logger ind‚Ä¶</h2>
        <p class="auth-subtitle">Vent mens login initialiseres.</p>
      </div>
      <div id="authLoginScreen" class="auth-section" hidden>
        <h2 class="auth-title">Log ind</h2>
        <p class="auth-subtitle">Log ind for at bruge akkordsedlen.</p>
        <div class="auth-actions">
          <button id="authGoogle" type="button" data-role="primary">Forts√¶t med Google</button>
        </div>
        <details id="authAdvanced" class="auth-advanced">
          <summary>Avanceret (email + kodeord)</summary>
          <div class="auth-fields">
            <label>
              <span>Email</span>
              <input id="authEmail" type="email" name="authEmail" autocomplete="email" inputmode="email">
            </label>
            <label>
              <span>Adgangskode</span>
              <input id="authPassword" type="password" name="authPassword" autocomplete="current-password">
            </label>
          </div>
          <div class="auth-actions">
            <button id="authLogin" type="button">Log ind</button>
            <button id="authSignup" type="button">Opret konto</button>
            <button id="authForgot" type="button" class="auth-link">Glemt kodeord</button>
          </div>
        </details>
      </div>
      <div id="authVerifyScreen" class="auth-section" hidden>
        <h2 class="auth-title">Bekr√¶ft din email</h2>
        <p class="auth-subtitle">Tjek din indbakke og bekr√¶ft din email for at f√• adgang.</p>
        <div class="auth-actions">
          <button id="authResend" type="button">Send igen</button>
          <button id="authVerified" type="button" data-role="primary">Jeg har verificeret</button>
          <button id="authLogout" type="button" class="auth-link">Log ud</button>
        </div>
      </div>
      <p id="authMessage" class="auth-message" aria-live="polite"></p>
    </div>
  </section>
  <div id="app" class="app-shell">
    <header data-allow-click>
      <div class="bar">
        <h1 class="ttl">akkordseddel</h1>
        <div class="topbar-nav">
          <nav class="tabs" role="tablist" aria-label="SSCaff sektioner">
              <button id="tab-sagsinfo" class="tab tab--active" type="button" role="tab" data-tab-id="sagsinfo" aria-controls="panel-sagsinfo" aria-selected="true">Sagsinfo</button>
              <button id="tab-optaelling" class="tab" type="button" role="tab" data-tab-id="optaelling" aria-controls="panel-optaelling" aria-selected="false">Opt√¶lling</button>
              <button id="tab-lon" class="tab" type="button" role="tab" data-tab-id="lon" aria-controls="panel-lon" aria-selected="false">L√∏n</button>
              <button id="tab-historik" class="tab" type="button" role="tab" data-tab-id="historik" aria-controls="panel-historik" aria-selected="false">Historik</button>
              <button id="tab-delte-sager" class="tab" type="button" role="tab" data-tab-id="delte-sager" aria-controls="panel-delte-sager" aria-selected="false">Delt sager</button>
              <button id="tab-team" class="tab" type="button" role="tab" data-tab-id="team" aria-controls="panel-team" aria-selected="false">Team</button>
              <button id="tab-hjaelp" class="tab" type="button" role="tab" data-tab-id="hjaelp" aria-controls="panel-hjaelp" aria-selected="false">Hj√¶lp</button>
            </nav>
          <div class="topbar-actions">
            <div class="ui-scale-control no-print" data-allow-click>
              <button id="uiScaleToggle" class="icon-button ui-scale-toggle" type="button" aria-haspopup="true" aria-expanded="false" aria-controls="uiScalePopover" aria-label="Juster zoom">üîç</button>
              <div id="uiScalePopover" class="ui-scale-popover" hidden>
                <div class="ui-scale-row">
                  <button type="button" class="ui-scale-chip" data-scale-step="-0.05" aria-label="Zoom ud">‚àí</button>
                  <span class="ui-scale-value" id="uiScaleValue">100%</span>
                  <button type="button" class="ui-scale-chip" data-scale-step="0.05" aria-label="Zoom ind">+</button>
                </div>
                <div class="ui-scale-row ui-scale-presets" role="group" aria-label="Zoom-forvalg">
                  <button type="button" class="ui-scale-chip" data-scale="0.75">75%</button>
                  <button type="button" class="ui-scale-chip" data-scale="0.9">90%</button>
                  <button type="button" class="ui-scale-chip" data-scale="1">100%</button>
                  <button type="button" class="ui-scale-chip" data-scale="1.1">110%</button>
                </div>
                <div class="ui-scale-row">
                  <button type="button" class="ui-scale-reset" data-scale-reset="1">Nulstil</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <button id="btnNewCase" type="button" data-role="secondary">Ny sag</button>
      </div>
    </header>
    <div class="app-content">
      <div class="materials-scroll">
        <main id="main" class="app-root">
          <div class="tab-panels" data-tab-panels>
  <section
    id="panel-sagsinfo"
    class="sektion tab-panel tab-panel--active"
    role="tabpanel"
    data-tab-panel="sagsinfo"
    aria-labelledby="tab-sagsinfo"
    aria-hidden="false"
  >
    <fieldset>
      <legend>Stamdata</legend>
      <div class="form-grid grid-3">
        <label>
          <span>Sagsnummer</span>
          <input type="text" id="sagsnummer" name="sagsnummer" required>
        </label>
        <label>
          <span>Navn/opgave</span>
          <input type="text" id="sagsnavn" name="navn" required>
        </label>
        <label>
          <span>Adresse</span>
          <input type="text" id="sagsadresse" name="adresse" required>
        </label>
        <label>
          <span>Kunde</span>
          <input type="text" id="sagskunde" name="kunde" required>
        </label>
        <div class="form-field date-field">
          <label for="sagsdato">
            <span>Dato</span>
          </label>
          <div class="date-input-wrapper">
            <input id="sagsdato" name="dato" type="date" required inputmode="numeric">
            <button type="button" id="calendarIcon" class="date-picker-trigger" aria-label="√Öbn kalender">üìÖ</button>
          </div>
        </div>
        <label class="col-span-3">
          <span>Mont√∏rnavne</span>
          <textarea id="sagsmontoer" name="montoer" rows="3" placeholder="Fx: Anna Jensen, Bo Nielsen" required></textarea>
        </label>
      </div>
      <div class="form-actions no-print">

      </div>
    </fieldset>

    <fieldset class="no-print">
      <legend>Import√©r akkordseddel</legend>
      <p class="hint">Indl√¶s en tidligere sag fra JSON-formatet for at genoptage eller lave demontage.</p>
      <div class="form-actions">
        <button id="btn-import-akkord" type="button">Import√©r akkordseddel</button>
        <input id="akkordImportInput" type="file" accept="application/json,.json" hidden>
      </div>
      <p id="actionHint" class="hint" role="status" aria-live="polite" aria-atomic="true">
        Udfyld Sagsinfo for at forts√¶tte.
      </p>
    </fieldset>
  </section>

  <section
    id="panel-optaelling"
    class="sektion tab-panel"
    role="tabpanel"
    data-tab-panel="optaelling"
    aria-labelledby="tab-optaelling"
    aria-hidden="true"
    hidden
  >
    <fieldset>
      <legend>Systemer</legend>
      <div id="listSelectors" class="row"></div>
    </fieldset>

    <fieldset>
      <legend>Materialer</legend>
      <div class="material-options no-print">
        <label class="toggle-selected">
          <input type="checkbox" id="showSelectedOnly">
          <span>Vis kun valgte materialer</span>
        </label>
      </div>

      <div id="materialSearchBar" class="no-print"></div>

      <div id="optaellingContainer" class="materials"></div>
    </fieldset>

  </section>

  <section
    id="panel-lon"
    class="sektion tab-panel"
    role="tabpanel"
    data-tab-panel="lon"
    aria-labelledby="tab-lon"
    aria-hidden="true"
    hidden
  >
    <fieldset class="no-print" data-allow-click>
      <legend>Admin</legend>
      <div class="row">
        <label class="sr-only" for="adminCode">Admin kode</label>
        <input type="text" id="adminCode" placeholder="Kode">
        <button id="btnAdminLogin" type="button">Log ind</button>
      </div>
      <p id="adminFeedback" class="status-message" hidden aria-live="polite"></p>
      <button id="btnHardResetApp" type="button" hidden>Nulstil app-data</button>
    </fieldset>
    <fieldset>
      <legend>Type &amp; bel√∏b</legend>
      <div class="grid-3">
        <label><span>Arbejdstype</span>
          <select id="jobType">
            <option value="montage">Montage</option>
            <option value="demontage">Demontage (50%)</option>
          </select>
        </label>
        <label><span>Montagepris (auto)</span>
          <input type="text" id="montagepris" placeholder="Montagepris (auto)" inputmode="decimal" data-numpad="true" data-decimal="comma" data-numpad-field="montagepris">
        </label>
        <label><span>Demontagepris (auto)</span>
          <input type="text" id="demontagepris" placeholder="Demontagepris (auto)" inputmode="decimal" data-numpad="true" data-decimal="comma" data-numpad-field="demontagepris">
        </label>
      </div>
    </fieldset>
    <fieldset>
      <legend>Till√¶g &amp; km</legend>
      <div class="grid-2">
          <div class="form-field">
            <label for="slaebePct">
              <span>Sl√¶b i %</span>
            </label>
            <div class="field-with-icon">
              <input type="text" id="slaebePct" placeholder="Sl√¶b i %" data-decimal="comma" data-numpad-field="slaebePct" data-a9-slaeb="true" data-numpad="off">
              <button type="button" class="a9-open-btn js-slaeb-calc-link" aria-label="√Öbn sl√¶b-procent app" data-calc-url="https://cala9.netlify.app/">üßÆ</button>
            </div>
            <div id="slaebPercentCalcInfo" class="help-text small-muted" aria-live="polite"></div>
          </div>
        <label><span>Km</span>
          <input type="text" id="km" placeholder="Km" inputmode="decimal" data-numpad="true" data-decimal="comma" data-numpad-field="km">
        </label>
      </div>
    </fieldset>

    <!-- LAYOUT-LOCK: R√¶kkef√∏lgen af l√∏n-sektioner m√• ikke flyttes uden at opdatere tests -->
    <section class="lon-section lon-extras">
      <fieldset>
        <legend>Ekstra arbejde</legend>
        <div class="grid-3 extra-work-grid">
          <label><span>Huller (antal)</span>
            <input type="text" id="antalBoringHuller" placeholder="Huller (antal)" inputmode="numeric" data-numpad="true" data-decimal="comma" data-testid="antal-input-1" data-numpad-field="antalBoringHuller">
          </label>
          <label><span>Luk af hul (antal)</span>
            <input type="text" id="antalLukHuller" placeholder="Luk af hul (antal)" inputmode="numeric" data-numpad="true" data-decimal="comma" data-numpad-field="antalLukHuller">
          </label>
          <label><span>Boring i beton (antal)</span>
            <input type="text" id="antalBoringBeton" placeholder="Boring i beton (antal)" inputmode="numeric" data-numpad="true" data-decimal="comma" data-numpad-field="antalBoringBeton">
          </label>
          <label><span>Opskydeligt r√¶kv√¶rk (antal)</span>
            <input type="text" id="antalOpskydeligt" placeholder="Opskydeligt r√¶kv√¶rk (antal)" inputmode="numeric" data-numpad="true" data-decimal="comma" data-numpad-field="antalOpskydeligt">
          </label>
          <label><span>Trallel√∏ft 0,35 (antal)</span>
            <input type="text" id="traelleloeft35" placeholder="Trallel√∏ft 0,35 (antal)" inputmode="numeric" data-numpad="true" data-decimal="comma" data-numpad-field="traelleloeft35">
          </label>
          <label><span>Trallel√∏ft 0,50 (antal)</span>
            <input type="text" id="traelleloeft50" placeholder="Trallel√∏ft 0,50 (antal)" inputmode="numeric" data-numpad="true" data-decimal="comma" data-numpad-field="traelleloeft50">
          </label>
        </div>
      </fieldset>
    </section>

    <section class="lon-section lon-workers no-print">
      <fieldset>
        <legend>Medarbejdere</legend>
        <div id="workers"></div>
        <div class="row">
          <button id="btnAddWorker" type="button">+ Tilf√∏j mand</button>
        </div>
      </fieldset>
    </section>

    <section class="lon-section lon-calc no-print">
      <div class="row btn-group">
        <button id="btnBeregnLon" type="button" data-role="primary">Beregn l√∏n</button>
      </div>
    </section>

    <section class="lon-section lon-result" data-lon-output hidden>
      <fieldset>
        <legend>Resultat</legend>
        <div id="lonResult"></div>
      </fieldset>
    </section>

    <section class="overview overview-inline lon-section" data-lon-output hidden>
      <div class="totals">
        <div>
          <span>Materialesum</span>
          <strong data-total="material">0,00</strong>
        </div>
        <div>
          <span>L√∏nsum</span>
          <strong data-total="labor">0,00</strong>
        </div>
        <div>
          <span>Projektsum</span>
          <strong data-total="project">0,00</strong>
        </div>
      </div>
    </section>

      <section class="lon-section lon-export no-print export-panel" data-lon-output hidden>
        <fieldset>
            <legend>Eksport &amp; deling</legend>
            <div class="export-actions" role="group" aria-label="Eksport muligheder">
              <button id="btn-print-akkord" type="button" disabled data-role="primary">Print</button>
              <button id="btn-export-akkord-pdf" type="button">Eksporter akkordseddel</button>
            </div>
          </fieldset>
        <fieldset class="export-comment">
          <legend>Kommentar</legend>
          <textarea id="akkordComment" name="comment" rows="4" placeholder="Tilf√∏j noter til akkorden‚Ä¶"></textarea>
        </fieldset>
      </section>

  </section>

    <section
      id="panel-historik"
      class="sektion tab-panel"
      role="tabpanel"
      data-tab-panel="historik"
      aria-labelledby="tab-historik"
      aria-hidden="true"
      hidden
    >
    <section class="card job-history no-print" aria-live="polite">
      <header class="card-header">
        <h2>Historik</h2>
        <p>V√¶lg en tidligere sag for at indl√¶se data eller se timel√∏n.</p>
      </header>
      <div class="job-history__controls">
        <label>
          <span>Seneste sager</span>
          <select id="jobHistorySelect" name="jobHistorySelect">
            <option value="" selected>Indl√¶ser sager‚Ä¶</option>
          </select>
        </label>
        <button id="btnLoadHistoryJob" type="button" disabled data-role="primary">Indl√¶s sag</button>
      </div>
      <div class="job-history__summary table-wrapper" aria-live="polite">
        <table>
          <thead>
            <tr>
              <th scope="col">Dato &amp; tid</th>
              <th scope="col">Timer</th>
              <th scope="col">Uden till√¶g</th>
              <th scope="col">Udd1</th>
              <th scope="col">Udd2</th>
              <th scope="col">Udd2 + mentor</th>
            </tr>
          </thead>
          <tbody id="job-history-summary-body">
            <tr>
              <td colspan="6">V√¶lg en sag for at se historik.</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="job-history__list">
        <h3>Seneste eksport/import</h3>
        <p class="job-history__hint">Historikken gemmes kun n√•r du eksporterer akkordsedlen. √Öbn review-loggen i debug-mappen for fuld oversigt over √¶ndringer.</p>
        <div class="history-table">
          <div class="history-table__head" aria-hidden="true">
            <span class="history-table__cell history-table__cell--date">Dato &amp; tid</span>
            <span class="history-table__cell history-table__cell--meta">Sag</span>
            <span class="history-table__cell history-table__cell--amount">Total</span>
            <span class="history-table__cell history-table__cell--actions">Handling</span>
          </div>
          <ul id="historyList" class="history-list history-table__body" aria-live="polite" aria-busy="true"></ul>
        </div>
      </div>
    </section>
  </section>

  <section
    id="panel-delte-sager"
    class="sektion tab-panel"
    role="tabpanel"
    data-tab-panel="delte-sager"
    aria-labelledby="tab-delte-sager"
    aria-hidden="true"
    hidden
  >
    <section class="card shared-cases no-print" aria-live="polite">
      <header class="card-header">
        <h2>Delt sager</h2>
        <p>F√¶lles sager publiceret fra teamet. Importer, download JSON eller gener√©r PDF on-demand.</p>
      </header>
      <div class="shared-filters">
        <label>
          <span>Jobnummer</span>
          <input id="sharedFilterJob" type="text" inputmode="search" placeholder="Filtr√©r jobnummer">
        </label>
        <label>
          <span>Status</span>
          <select id="sharedFilterStatus">
            <option value="">Alle</option>
            <option value="kladde">Kladde</option>
            <option value="godkendt">Godkendt</option>
          </select>
        </label>
        <label>
          <span>Type</span>
          <select id="sharedFilterKind">
            <option value="">Alle</option>
            <option value="montage">Montage</option>
            <option value="demontage">Demontage</option>
          </select>
        </label>
        <div class="shared-filter-actions">
          <button id="refreshSharedCases" type="button">Opdater</button>
        </div>
      </div>
      <div id="sharedCasesList" class="shared-cases-list" aria-live="polite"></div>
    </section>
  </section>

    <section
    id="panel-team"
    class="sektion tab-panel"
    role="tabpanel"
    data-tab-panel="team"
    aria-labelledby="tab-team"
    aria-hidden="true"
    hidden
  >
    <!-- Mount point for app guard (team access checking) -->
    <div id="teamGuardMount"></div>

    <!-- Team status and controls (moved from Delt sager) -->
    <section class="card team-status-controls no-print" aria-live="polite">
      <div class="shared-status-card" aria-live="polite">
        <div class="shared-status-row"><span>Logget ind:</span><strong id="sharedStatusLoggedIn">Nej</strong></div>
        <div class="shared-status-row"><span>Bruger:</span><strong id="sharedStatusUser">‚Äì</strong></div>
        <div class="shared-status-row shared-status-row--uid">
          <span>UID:</span>
          <div class="shared-status-uid">
            <strong id="sharedStatusUid">‚Äì</strong>
            <button id="sharedUidCopy" type="button">Kopi√©r</button>
          </div>
        </div>
        <div class="shared-status-row"><span>Team ID:</span><strong id="sharedStatusTeam">‚Äì</strong></div>
        <div class="shared-status-row"><span>Rolle:</span><strong id="sharedStatusRole">ikke medlem</strong></div>
      </div>
      <div class="shared-auth-controls" aria-live="polite">
        <button id="sharedLogout" type="button" class="shared-logout" hidden>Log ud</button>
      </div>
      <div id="teamIdInputContainer" class="team-id-input">
        <label for="teamIdInput">Team ID:</label>
        <input id="teamIdInput" type="text" placeholder="f.eks. hulmose">
        <button id="saveTeamId" type="button">Gem</button>
        <button id="sharedBootstrapTeam" type="button" class="shared-bootstrap" hidden>Opret team + tilf√∏j mig</button>
      </div>
      <div class="shared-admin-actions">
        <button id="sharedBackupExport" type="button" disabled>Eksporter backup</button>
        <label class="sr-only" for="sharedBackupImport">Importer backup</label>
        <input id="sharedBackupImport" type="file" accept="application/json" disabled>
      </div>
    </section>

    <section class="card team-member-overview no-print" id="teamMemberOverview" aria-live="polite" hidden>
      <header class="card-header">
        <h2>Medlemmer</h2>
        <p>Du er medlem af teamet. Listen er skrivebeskyttet.</p>
      </header>
      <div id="teamMembersListReadOnly" class="team-admin__list"></div>
    </section>

    <section class="card team-admin no-print" aria-live="polite">
      <header class="card-header">
        <h2>Team administration</h2>
        <p>Se teaminfo og administrer medlemmer. Medlemmer kan se listen, admin/owner kan redigere.</p>
      </header>
      <div class="team-admin__meta">
        <div>
          <span>Team navn</span>
          <div class="field-with-icon">
            <strong id="teamName">‚Äì</strong>
            <button id="teamCopyName" type="button">Kopi√©r</button>
          </div>
        </div>
        <div>
          <span>Team ID</span>
          <div class="field-with-icon">
            <strong id="teamId">‚Äì</strong>
            <button id="teamCopyId" type="button">Kopi√©r</button>
          </div>
        </div>
      </div>
      <div class="team-admin__actions">
        <div class="team-admin__invite">
          <label for="teamInviteEmailTeamPage">Email</label>
          <input id="teamInviteEmailTeamPage" type="email" autocomplete="email" placeholder="bruger@firma.dk">
          <label for="teamInviteRoleTeamPage">Rolle</label>
          <select id="teamInviteRoleTeamPage">
            <option value="member">Medlem</option>
            <option value="admin">Admin</option>
          </select>
          <button id="teamInviteSubmitTeamPage" type="button">Invit√©r</button>
        </div>
        <div class="team-admin__invite">
          <label for="teamUidInput">Tilf√∏j via UID</label>
          <input id="teamUidInput" type="text" placeholder="UID">
          <label for="teamUidRole">Rolle</label>
          <select id="teamUidRole">
            <option value="member">Medlem</option>
            <option value="admin">Admin</option>
          </select>
          <button id="teamUidSubmit" type="button">Tilf√∏j medlem</button>
        </div>
      </div>
      <div class="team-admin__lists">
        <div class="team-admin__card">
          <h4>Medlemmer</h4>
          <div id="teamMembersListTeamPage" class="team-admin__list"></div>
        </div>
        <div class="team-admin__card">
          <h4>Invitationer</h4>
          <div id="teamInvitesListTeamPage" class="team-admin__list"></div>
        </div>
      </div>
      <div class="btn-group">
        <button id="teamRefresh" type="button">Opdater</button>
        <button id="teamFixMembership" type="button">Ret medlemskab (Ren√©)</button>
      </div>
      <p id="teamAdminStatus" class="status-message" aria-live="polite"></p>
    </section>
  </section>

  <section
    id="panel-hjaelp"
    class="sektion tab-panel"
    role="tabpanel"
    data-tab-panel="hjaelp"
    aria-labelledby="tab-hjaelp"
    aria-hidden="true"
    hidden
  >
    <fieldset>
      <legend>S√•dan bruger du akkordsedlen</legend>
      <ol>
        <li>Udfyld <strong>Sagsinfo</strong> med sagsnummer, kunde, adresse, mont√∏rer og dato.</li>
        <li>G√• til <strong>Opt√¶lling</strong>, v√¶lg system og indtast antal materialer.</li>
        <li>√Öbn <strong>L√∏n</strong>, v√¶lg arbejdstype, timer, km og eventuelt ekstraarbejde.</li>
        <li>Tjek <strong>Resultat</strong> og brug <strong>Eksport &amp; deling</strong> til PDF eller JSON.</li>
        <li>Find tidligere sager under <strong>Historik</strong> for hurtig genindl√¶sning.</li>
      </ol>
    </fieldset>
    <fieldset>
      <legend>Typiske fejl &amp; l√∏sninger</legend>
      <ul>
        <li><strong>Ekstraarbejde er 0 kr:</strong> Tjek at antal for huller/boring/trallel√∏ft er udfyldt.</li>
        <li><strong>Ingen fil downloades:</strong> Sl√• evt. popup-blokering fra eller tillad downloads fra browseren.</li>
        <li><strong>Sagen er v√¶k:</strong> Kig i <strong>Historik</strong> eller genindl√¶s en gemt JSON-fil.</li>
      </ul>
    </fieldset>
    <fieldset>
      <legend>Offline cache</legend>
      <p class="hint">Hvis appen h√¶nger i en gammel version, kan du nulstille offline cache og service worker.</p>
      <div class="form-actions">
        <button id="btnResetOfflineCache" type="button">Nulstil offline cache</button>
      </div>
    </fieldset>
    <fieldset>
      <legend>Admin-tilstand</legend>
      <ul>
        <li>Indtast adminkoden fra administratoren for at l√•se prisfelter og avancerede muligheder op.</li>
        <li>Bruges kun af ansvarlige/admin ‚Äì almindelige brugere skal forblive i normal tilstand.</li>
        <li>P√•virker eksport og ops√¶tning, men √¶ndrer ikke de underliggende beregningsregler.</li>
      </ul>
    </fieldset>
    <fieldset>
      <legend>Zoom ind/ud (hvis du ikke kan se hele materialenavnet)</legend>
      <h3>iPhone / iPad (Safari eller Chrome)</h3>
      <ul>
        <li>Knib med to fingre for at zoome ud. Spred fingrene for at zoome ind. ([Apple Support][1])</li>
        <li>Hvis hele sk√¶rmen pludselig er forst√∏rret: tryk to gange med <strong>tre fingre</strong> for at zoome ud (iOS Zoom-funktion). ([Apple Support][2])</li>
      </ul>
      <h3>Android (Chrome)</h3>
      <ul>
        <li>Knib med to fingre for at zoome ud, spred fingrene for at zoome ind.</li>
        <li>Hvis zoom ikke virker p√• en side: Chrome ‚Üí <strong>‚ãÆ</strong> ‚Üí <strong>Indstillinger</strong> ‚Üí <strong>Tilg√¶ngelighed</strong> ‚Üí sl√• ‚ÄúForce enable zoom‚Äù til. ([fcscontrol.zendesk.com][3])</li>
        <li>Nogle Chrome-versioner har ogs√• zoom i <strong>‚ãÆ menuen</strong> via en zoom-slider. ([The Verge][4])</li>
      </ul>
      <h3>Android (Samsung Internet)</h3>
      <ul>
          <li>Dobbelt-tap eller knib for at zoome ud/ind. ([B&amp;H Photo Video][5])</li>
      </ul>
      <h3>Installeret app (PWA)</h3>
      <ul>
        <li>Brug üîé-ikonet i appen til at zoome 75%‚Äì110% (Nulstil = 100%).</li>
      </ul>
    </fieldset>
  </section>
          </div>
        </main>

      </div>
    </div>

  </div>

    <div id="numpad-overlay" class="numpad-hidden" data-numpad-overlay hidden inert>
      <div
        class="numpad-panel numpad-container"
        role="dialog"
        aria-modal="true"
        aria-label="Numpad lommeregner"
        tabindex="-1"
        data-numpad-dialog
      >
        <div class="numpad-topbar">
          <button type="button" class="numpad-close" id="numpad-btn-close" aria-label="Luk lommeregner">‚úï</button>
        </div>

        <div class="numpad-display" aria-live="polite">
          <div class="numpad-display-expression" id="numpad-display-expression"></div>
          <div class="numpad-display-current" id="numpad-display-current">0</div>
        </div>

        <div class="numpad-grid">
          <button type="button" data-key="C" class="numpad-key numpad-key-func">C</button>
          <button type="button" data-key="√∑" class="numpad-key numpad-key-op numpad-key--op numpad-operator">√∑</button>
          <button type="button" data-key="√ó" class="numpad-key numpad-key-op numpad-key--op numpad-operator">√ó</button>
          <button type="button" data-key="BACK" class="numpad-key numpad-key-func">‚å´</button>

          <button type="button" data-key="7" class="numpad-key">7</button>
          <button type="button" data-key="8" class="numpad-key">8</button>
          <button type="button" data-key="9" class="numpad-key">9</button>
          <button type="button" data-key="-" class="numpad-key numpad-key-op numpad-key--op numpad-operator">-</button>

          <button type="button" data-key="4" class="numpad-key">4</button>
          <button type="button" data-key="5" class="numpad-key">5</button>
          <button type="button" data-key="6" class="numpad-key">6</button>
          <button type="button" data-key="+" class="numpad-key numpad-key-op numpad-key--op numpad-operator">+</button>

          <button type="button" data-key="1" class="numpad-key">1</button>
          <button type="button" data-key="2" class="numpad-key">2</button>
          <button type="button" data-key="3" class="numpad-key">3</button>
          <button type="button" data-key="=" class="numpad-key numpad-key-eq key-equal">=</button>

          <button type="button" data-key="%" class="numpad-key numpad-key-func">%</button>
          <button type="button" data-key="0" class="numpad-key">0</button>
          <button type="button" data-key="," class="numpad-key numpad-key-op numpad-operator">,</button>
        </div>

        <p class="numpad-hint">Brug tastatur eller knapperne herover, og tryk Enter eller Gem for at opdatere feltet.</p>

        <button type="button" class="numpad-commit" id="numpad-btn-commit">
          <span class="numpad-commit__label">Gem</span>
          <span aria-hidden="true" class="numpad-commit__icon">‚úì</span>
        </button>
      </div>
    </div>

  <div id="a9-overlay" class="a9-hidden">
    <div class="a9-panel" role="dialog" aria-label="Sl√¶b i % lommeregner" tabindex="-1">
      <button type="button" class="a9-close" id="a9-btn-close" aria-label="Luk lommeregner">‚úï</button>
      <div class="a9-display">
        <div class="a9-display-top" id="a9-display-expression"></div>
        <div class="a9-display-mid" id="a9-display-previous"></div>
        <div class="a9-display-main" id="a9-display-current">0</div>
      </div>
      <div class="a9-actions">
        <button type="button" class="a9-copy" id="a9-btn-copy">üìã Kopi√©r formel</button>
      </div>
      <div class="a9-grid">
        <button data-a9-key="C" class="a9-key a9-func" type="button">C</button>
        <button data-a9-key="MC" class="a9-key a9-func" type="button">mc</button>
        <button data-a9-key="MR" class="a9-key a9-func" type="button">mr</button>
        <button data-a9-key="M-" class="a9-key a9-func" type="button">m-</button>
        <button data-a9-key="M+" class="a9-key a9-func" type="button">m+</button>

        <button data-a9-key="BACK" class="a9-key a9-func" type="button">‚å´</button>
        <button data-a9-key="√∑" class="a9-key a9-op" type="button">√∑</button>
        <button data-a9-key="√ó" class="a9-key a9-op" type="button">√ó</button>
        <button data-a9-key="-" class="a9-key a9-op" type="button">-</button>

        <button data-a9-key="7" class="a9-key" type="button">7</button>
        <button data-a9-key="8" class="a9-key" type="button">8</button>
        <button data-a9-key="9" class="a9-key" type="button">9</button>
        <button data-a9-key="+" class="a9-key a9-op" type="button">+</button>

        <button data-a9-key="4" class="a9-key" type="button">4</button>
        <button data-a9-key="5" class="a9-key" type="button">5</button>
        <button data-a9-key="6" class="a9-key" type="button">6</button>
        <button data-a9-key="=" class="a9-key a9-eq" type="button">=</button>

        <button data-a9-key="1" class="a9-key" type="button">1</button>
        <button data-a9-key="2" class="a9-key" type="button">2</button>
        <button data-a9-key="3" class="a9-key" type="button">3</button>
        <button data-a9-key="%" class="a9-key a9-func" type="button">%</button>

        <button data-a9-key="0" class="a9-key a9-wide" type="button">0</button>
        <button data-a9-key="," class="a9-key" type="button">,</button>
      </div>
      <button type="button" class="a9-commit" id="a9-btn-commit">‚úì Brug som sl√¶b %</button>
    </div>
  </div>

<script src="js/version.js" defer></script>
<script type="module" src="main.min.js" defer></script>
<noscript><link rel="stylesheet" href="style.css"></noscript>
<noscript><link rel="stylesheet" href="print.css" media="print"></noscript>
</body>
</html>

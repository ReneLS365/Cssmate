<!doctype html>
<html lang=da>
<head>
  
  <meta charset=utf-8>
  <meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name=description content="CSMate ‚Äì stilladsopt√¶lling, akkord og PWA til byggepladsen.">
  <meta name=theme-color content=#0f172a>
  <meta name=apple-mobile-web-app-capable content=yes>
  <meta name=apple-mobile-web-app-status-bar-style content=black-translucent>
  <title>akkordseddel</title>
  <link rel=stylesheet href=style.css>
  <link rel=stylesheet href=css/numpad.css>
  <link rel=stylesheet href=css/a9-calc.css>
  <link rel=stylesheet href=print.css media=print>
  <link rel=stylesheet href=src/styles/fixes.css>
  <link rel=stylesheet href=/css/pwa.css>
  <link rel=manifest href=/manifest.webmanifest crossorigin=anonymous>
  <link rel=apple-touch-icon href=/icons/icon-192.png>
  <link rel=canonical href=https://sscaff.netlify.app/ >
</head>
<body>
  <a class=skip-to-content href=#main>Spring til indhold</a>
  <div id=iosInstallPrompt class=ios-install-prompt role=region aria-live=polite hidden>
    <p>Tilf√∏j CSMate til hjemmesk√¶rmen: Tryk p√• delingsknappen og v√¶lg <strong>F√∏j til hjemmesk√¶rm</strong>.</p>
    <button type=button id=iosInstallDismiss class=ios-install-dismiss aria-label="Skjul iOS installationshint">‚úï</button>
  </div>
  <div class="pwa-install-wrap no-print">
    <button type=button id=installBtn class=pwa-install-btn hidden>Installer app</button>
  </div>
  <div id=app class=app-shell>
    <header data-allow-click>
      <div class=bar>
        <h1 class=ttl>akkordseddel</h1>
        <nav class="tabs" role="tablist" aria-label="SSCaff sektioner">
          <button id="tab-sagsinfo" class="tab tab--active" type="button" role="tab" data-tab-id="sagsinfo" aria-controls="panel-sagsinfo" aria-selected="true">Sagsinfo</button>
          <button id="tab-optaelling" class="tab" type="button" role="tab" data-tab-id="optaelling" aria-controls="panel-optaelling" aria-selected="false">Opt√¶lling</button>
          <button id="tab-lon" class="tab" type="button" role="tab" data-tab-id="lon" aria-controls="panel-lon" aria-selected="false">L√∏n</button>
          <button id="tab-hjaelp" class="tab" type="button" role="tab" data-tab-id="hjaelp" aria-controls="panel-hjaelp" aria-selected="false">Hj√¶lp</button>
        </nav>
      </div>
    </header>
    <div class=app-content>
      <div class=materials-scroll>
        <main id=main class="app-root">
          <div class="tab-panels" data-tab-panels>
  <section
    id="panel-sagsinfo"
    class="sektion tab-panel tab-panel--active"
    role="tabpanel"
    data-tab-panel="sagsinfo"
    aria-labelledby="tab-sagsinfo"
    aria-hidden="false"
  >
    <fieldset>
      <legend>Stamdata</legend>
      <div class="form-grid grid-3">
        <label for=sagsnummer>
          <span>Sagsnummer</span>
          <input id=sagsnummer name=sagsnummer required>
        </label>
        <label for=sagsnavn>
          <span>Navn/opgave</span>
          <input id=sagsnavn name=navn required>
        </label>
        <label for=sagsadresse>
          <span>Adresse</span>
          <input id=sagsadresse name=adresse required>
        </label>
        <label for=sagskunde>
          <span>Kunde</span>
          <input id=sagskunde name=kunde required>
        </label>
        <label for=sagsdato class=date-field>
          <span>Dato</span>
          <div class=date-input-wrapper>
            <input id=sagsdato name=dato type=date required inputmode=numeric>
            <button id=calendarIcon class=date-picker-trigger type=button aria-label="√Öbn kalender">üìÖ</button>
          </div>
        </label>
        <label for=sagsmontoer class=col-span-3>
          <span>Mont√∏rnavne</span>
          <textarea id=sagsmontoer name=montoer rows=3 placeholder="Fx: Anna Jensen, Bo Nielsen" required></textarea>
        </label>
      </div>
      <div class="form-actions no-print">
        <button id=btnOpenGuideModal type=button>√Öbn guide</button>
      </div>
    </fieldset>

    <section class="card job-history no-print" aria-live=polite>
      <header class="card-header">
        <h2>Historik</h2>
        <p>V√¶lg en tidligere sag for at indl√¶se data eller se timel√∏n.</p>
      </header>
      <div class="job-history__controls">
        <label for=jobHistorySelect>
          <span>Seneste sager</span>
          <select id=jobHistorySelect name=jobHistorySelect>
            <option value="" selected>Indl√¶ser sager‚Ä¶</option>
          </select>
        </label>
        <button id=btnLoadHistoryJob type=button disabled>Indl√¶s sag</button>
      </div>
      <div class="job-history__summary table-wrapper" aria-live=polite>
        <table>
          <thead>
            <tr>
              <th scope=col>Dato &amp; tid</th>
              <th scope=col>Timer</th>
              <th scope=col>Uden till√¶g</th>
              <th scope=col>Udd1</th>
              <th scope=col>Udd2</th>
              <th scope=col>Udd2 + mentor</th>
            </tr>
          </thead>
          <tbody id=job-history-summary-body>
            <tr>
              <td colspan=6>V√¶lg en sag for at se historik.</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="job-history__list">
        <h3>Seneste eksport/import</h3>
        <p class="job-history__hint">Historikken opdateres automatisk efter beregning. √Öbn review-loggen i debug-mappen for fuld oversigt over √¶ndringer.</p>
        <ul id=historyList class="history-list" aria-live=polite aria-busy=true></ul>
      </div>
    </section>

    <fieldset>
      <legend>Status</legend>
      <p class=hint>Udfyld Sagsinfo og Opt√¶lling for at aktivere eksport.</p>
      <p id=actionHint class="hint no-print" role=status aria-live=polite aria-atomic=true>
        Udfyld Sagsinfo for at forts√¶tte.
      </p>
    </fieldset>
  </section>

  <section
    id="panel-optaelling"
    class="sektion tab-panel"
    role="tabpanel"
    data-tab-panel="optaelling"
    aria-labelledby="tab-optaelling"
    aria-hidden="true"
    hidden
  >
    <fieldset>
      <legend>Systemer</legend>
      <div id=listSelectors class=row></div>
    </fieldset>

    <fieldset>
      <legend>Materialer</legend>
      <div class="material-options no-print">
        <label class=toggle-selected>
          <input type=checkbox id=showSelectedOnly>
          <span>Vis kun valgte materialer</span>
        </label>
      </div>

      <div id=optaellingContainer class=materials></div>
    </fieldset>

  </section>

  <section
    id="panel-lon"
    class="sektion tab-panel"
    role="tabpanel"
    data-tab-panel="lon"
    aria-labelledby="tab-lon"
    aria-hidden="true"
    hidden
  >
    <fieldset class=no-print data-allow-click>
      <legend>Admin</legend>
      <div class=row>
        <label class=sr-only for=adminCode>Admin kode</label>
        <input id=adminCode placeholder=Kode>
        <button id=btnAdminLogin type=button>Log ind</button>
      </div>
      <p id=adminFeedback class=status-message hidden aria-live=polite></p>
      <button id=btnHardResetApp type=button hidden>Nulstil app-data</button>
    </fieldset>
    <fieldset>
      <legend>Type & bel√∏b</legend>
      <div class=grid-3>
        <label for=jobType><span>Arbejdstype</span>
          <select id=jobType>
            <option value=montage>Montage</option>
            <option value=demontage>Demontage (50%)</option>
          </select>
        </label>
        <label for=montagepris><span>Montagepris (auto)</span>
          <input id=montagepris placeholder="Montagepris (auto)" inputmode=decimal data-numpad=true data-decimal=comma data-numpad-field=montagepris>
        </label>
        <label for=demontagepris><span>Demontagepris (auto)</span>
          <input id=demontagepris placeholder="Demontagepris (auto)" inputmode=decimal data-numpad=true data-decimal=comma data-numpad-field=demontagepris>
        </label>
      </div>
    </fieldset>
    <fieldset>
      <legend>Till√¶g & km</legend>
      <div class=grid-2>
        <label for=slaebePct><span>Sl√¶b i %</span>
          <div class=field-with-icon>
            <input id=slaebePct placeholder="Sl√¶b i %" data-decimal=comma data-numpad-field=slaebePct data-a9-slaeb=true data-numpad=off>
            <button type=button class="a9-open-btn js-slaeb-calc-link" aria-label="√Öbn sl√¶b-procent app" data-calc-url="https://cala9.netlify.app/">üßÆ</button>
          </div>
          <div id=slaebPercentCalcInfo class="help-text small-muted" aria-live=polite></div>
        </label>
        <label for=km><span>Km</span>
          <input id=km placeholder=Km inputmode=decimal data-numpad=true data-decimal=comma data-numpad-field=km>
        </label>
      </div>
    </fieldset>

    <fieldset>
      <legend>Ekstra arbejde</legend>
      <div class="grid-3 extra-work-grid">
        <label for=antalBoringHuller><span>Huller (antal)</span>
          <input id=antalBoringHuller placeholder="Huller (antal)" inputmode=numeric data-numpad=true data-decimal=comma data-testid=antal-input-1 data-numpad-field=antalBoringHuller>
        </label>
        <label for=antalLukHuller><span>Luk af hul (antal)</span>
          <input id=antalLukHuller placeholder="Luk af hul (antal)" inputmode=numeric data-numpad=true data-decimal=comma data-numpad-field=antalLukHuller>
        </label>
        <label for=antalBoringBeton><span>Boring i beton (antal)</span>
          <input id=antalBoringBeton placeholder="Boring i beton (antal)" inputmode=numeric data-numpad=true data-decimal=comma data-numpad-field=antalBoringBeton>
        </label>
        <label for=antalOpskydeligt><span>Opskydeligt r√¶kv√¶rk (antal)</span>
          <input id=antalOpskydeligt placeholder="Opskydeligt r√¶kv√¶rk (antal)" inputmode=numeric data-numpad=true data-decimal=comma data-numpad-field=antalOpskydeligt>
        </label>
        <label for=traelleloeft35><span>Trallel√∏ft 0,35 (antal)</span>
          <input id=traelleloeft35 placeholder="Trallel√∏ft 0,35 (antal)" inputmode=numeric data-numpad=true data-decimal=comma data-numpad-field=traelleloeft35>
        </label>
        <label for=traelleloeft50><span>Trallel√∏ft 0,50 (antal)</span>
          <input id=traelleloeft50 placeholder="Trallel√∏ft 0,50 (antal)" inputmode=numeric data-numpad=true data-decimal=comma data-numpad-field=traelleloeft50>
        </label>
      </div>
    </fieldset>

    <section class="overview overview-inline">
      <div class=totals>
        <div>
          <span>Materialesum</span>
          <strong data-total=material>0,00</strong>
        </div>
        <div>
          <span>L√∏nsum</span>
          <strong data-total=labor>0,00</strong>
        </div>
        <div>
          <span>Projektsum</span>
          <strong data-total=project>0,00</strong>
        </div>
      </div>
    </section>

    <div class="row no-print btn-group">
      <button id=btnBeregnLon type=button>Beregn l√∏n</button>
      <button id=btnPrint type=button disabled>Print</button>
    </div>
    <fieldset class="no-print export-panel">
      <legend>Eksport & deling</legend>
      <div class="export-actions" role="group" aria-label="Eksport muligheder">
        <button id=btnExportCSV type=button>CSV</button>
        <button id=btnExportAll type=button>JSON</button>
        <button id=btnExportZip type=button>ZIP</button>
        <button id=btnExportEkomplet type=button>E-komplet</button>
      </div>
      <fieldset class="export-system-selector">
        <legend>Excel 25-ark</legend>
        <p class="hint">V√¶lg de systemer der skal have et 25-ark. Kun BOSTA er valgt som standard.</p>
        <div id=akkordExcelSystemOptions class="export-system-options" role=group aria-label="Excel systemvalg">
          <label class="export-system-option" data-system=bosta>
            <input type=checkbox name=akkordExcelSystem value=bosta checked>
            <span class="export-system-option__label">BOSTA 2025</span>
            <small class="export-system-option__hint" aria-live=polite></small>
          </label>
          <label class="export-system-option" data-system=haki>
            <input type=checkbox name=akkordExcelSystem value=haki>
            <span class="export-system-option__label">HAKI 2025</span>
            <small class="export-system-option__hint" aria-live=polite></small>
          </label>
          <label class="export-system-option" data-system=modex>
            <input type=checkbox name=akkordExcelSystem value=modex>
            <span class="export-system-option__label">MODEX 2025</span>
            <small class="export-system-option__hint" aria-live=polite></small>
          </label>
        </div>
      </fieldset>
      <p id=ekompletStatus class="status-message" hidden aria-live=polite></p>
    </fieldset>
    <fieldset>
      <legend>Resultat</legend>
      <div id=lonResult></div>
    </fieldset>

    <fieldset class=no-print>
      <legend>Medarbejdere</legend>
      <div id=workers></div>
      <div class=row>
        <button id=btnAddWorker type=button>+ Tilf√∏j mand</button>
      </div>
    </fieldset>
  </section>

  <section
    id="panel-hjaelp"
    class="sektion tab-panel"
    role="tabpanel"
    data-tab-panel="hjaelp"
    aria-labelledby="tab-hjaelp"
    aria-hidden="true"
    hidden
  >
    <fieldset>
      <legend>Hurtig hj√¶lp</legend>
      <ol>
        <li>Udfyld alle felter i <strong>Sagsinfo</strong>.</li>
        <li>V√¶lg systemer og registr√©r materialer under <strong>Opt√¶lling</strong>.</li>
        <li>Beregn og eksporter fra <strong>L√∏n</strong>.</li>
      </ol>
    </fieldset>
    <fieldset>
      <legend>Support</legend>
      <p class=hint>Kontakt administratoren hvis data skal nulstilles eller hvis eksporten fejler.</p>
      <p class=hint>Se ogs√• logfilerne i <code>/debug</code>-mappen for fejlfinding.</p>
    </fieldset>
  </section>
          </div>
        </main>

      </div>
    </div>

    <div id=guideModal class=modal hidden aria-hidden=true>
      <div class=modal-content role=dialog aria-modal=true aria-labelledby=guideModalTitle tabindex=-1>
        <button type=button class=modal-close aria-label=Luk>√ó</button>
        <h2 id=guideModalTitle>Guide til CSMate</h2>
        <p>
          F√∏lg disse trin for at genskabe den stabile arbejdsgang:
        </p>
        <ol>
          <li>Udfyld <strong>Sagsinfo</strong> med de grundl√¶ggende oplysninger.</li>
          <li>V√¶lg system i <strong>Opt√¶lling</strong> og indtast materialer.</li>
          <li>Udskriv eller eksport√©r akkordsedlen fra <strong>L√∏n</strong> fanen.</li>
          <li>Tilf√∏j medarbejdere under <strong>L√∏n</strong> og beregn akkord.</li>
        </ol>
        <p>
          Har du brug for yderligere hj√¶lp, kan du kontakte administratoren eller sl√• op i virksomhedens
          interne vejledninger.
        </p>
      </div>
    </div>
  </div>

    <div id="numpad-overlay" class="numpad-hidden" aria-hidden="true" data-numpad-overlay>
      <div
        class="numpad-panel"
        role="dialog"
        aria-modal="true"
        aria-label="Numpad lommeregner"
        tabindex="-1"
        data-numpad-dialog
      >
        <div class="numpad-topbar">
          <button type="button" class="numpad-close" id="numpad-btn-close" aria-label="Luk lommeregner">‚úï</button>
        </div>

        <div class="numpad-display" aria-live="polite">
          <div class="numpad-display-expression" id="numpad-display-expression"></div>
          <div class="numpad-display-current" id="numpad-display-current">0</div>
        </div>

        <div class="numpad-grid">
          <button data-key="C" class="numpad-key numpad-key-func">C</button>
          <button data-key="√∑" class="numpad-key numpad-key-op numpad-key--op">√∑</button>
          <button data-key="√ó" class="numpad-key numpad-key-op numpad-key--op">√ó</button>
          <button data-key="BACK" class="numpad-key numpad-key-func">‚å´</button>

          <button data-key="7" class="numpad-key">7</button>
          <button data-key="8" class="numpad-key">8</button>
          <button data-key="9" class="numpad-key">9</button>
          <button data-key="-" class="numpad-key numpad-key-op numpad-key--op">-</button>

          <button data-key="4" class="numpad-key">4</button>
          <button data-key="5" class="numpad-key">5</button>
          <button data-key="6" class="numpad-key">6</button>
          <button data-key="+" class="numpad-key numpad-key-op numpad-key--op">+</button>

          <button data-key="1" class="numpad-key">1</button>
          <button data-key="2" class="numpad-key">2</button>
          <button data-key="3" class="numpad-key">3</button>
          <button data-key="=" class="numpad-key numpad-key-eq key-equal">=</button>

          <button data-key="%" class="numpad-key numpad-key-func">%</button>
          <button data-key="0" class="numpad-key">0</button>
          <button data-key="," class="numpad-key numpad-key-op">,</button>
        </div>

        <button type="button" class="numpad-commit" id="numpad-btn-commit">‚úì</button>
      </div>
    </div>

  <div id=a9-overlay class=a9-hidden aria-hidden=true>
    <div class=a9-panel role=dialog aria-label="Sl√¶b i % lommeregner" tabindex=-1>
      <button type=button class=a9-close id=a9-btn-close aria-label="Luk lommeregner">‚úï</button>
      <div class=a9-display>
        <div class=a9-display-top id=a9-display-expression></div>
        <div class=a9-display-mid id=a9-display-previous></div>
        <div class=a9-display-main id=a9-display-current>0</div>
      </div>
      <div class=a9-actions>
        <button type=button class=a9-copy id=a9-btn-copy>üìã Kopi√©r formel</button>
      </div>
      <div class=a9-grid>
        <button data-a9-key=C class="a9-key a9-func" type=button>C</button>
        <button data-a9-key=MC class="a9-key a9-func" type=button>mc</button>
        <button data-a9-key=MR class="a9-key a9-func" type=button>mr</button>
        <button data-a9-key=M- class="a9-key a9-func" type=button>m-</button>
        <button data-a9-key=M+ class="a9-key a9-func" type=button>m+</button>

        <button data-a9-key=BACK class="a9-key a9-func" type=button>‚å´</button>
        <button data-a9-key=√∑ class="a9-key a9-op" type=button>√∑</button>
        <button data-a9-key=√ó class="a9-key a9-op" type=button>√ó</button>
        <button data-a9-key=- class="a9-key a9-op" type=button>-</button>

        <button data-a9-key=7 class=a9-key type=button>7</button>
        <button data-a9-key=8 class=a9-key type=button>8</button>
        <button data-a9-key=9 class=a9-key type=button>9</button>
        <button data-a9-key=+ class="a9-key a9-op" type=button>+</button>

        <button data-a9-key=4 class=a9-key type=button>4</button>
        <button data-a9-key=5 class=a9-key type=button>5</button>
        <button data-a9-key=6 class=a9-key type=button>6</button>
        <button data-a9-key== class="a9-key a9-eq" type=button>=</button>

        <button data-a9-key=1 class=a9-key type=button>1</button>
        <button data-a9-key=2 class=a9-key type=button>2</button>
        <button data-a9-key=3 class=a9-key type=button>3</button>
        <button data-a9-key=% class="a9-key a9-func" type=button>%</button>

        <button data-a9-key=0 class="a9-key a9-wide" type=button>0</button>
        <button data-a9-key=, class=a9-key type=button>,</button>
      </div>
      <button type=button class=a9-commit id=a9-btn-commit>‚úì Brug som sl√¶b %</button>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script type="module" src="main.js"></script>
